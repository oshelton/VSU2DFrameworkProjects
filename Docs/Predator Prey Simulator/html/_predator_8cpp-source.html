<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Simulator: J:/course work/2d Framework  Projects/Source/Predator Prey Simulator/Source/Predator.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>J:/course work/2d Framework Projects/Source/Predator Prey Simulator/Source/Predator.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;TimerManager.h&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;Utils.h&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;SceneNode.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "SimulationManager.h"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "Environment.h"</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include "predatorManager.h"</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include "PredatorBehavior.h"</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include "PredatorBehaviorFamily.h"</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include "Prey.h"</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include "ReportManager.h"</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include "ReportSection.h"</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include "PreyManager.h"</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include "Predator.h"</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="keyword">using namespace </span>std;
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="class_predator.html#bf49ce73fe2d506d2ac80281c3cb074e">00023</a> <a class="code" href="class_predator.html#bf49ce73fe2d506d2ac80281c3cb074e" title="Constructor.">Predator::Predator</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; species) : <a class="code" href="class_animal.html" title="Basic Animal class, holds all fields and methods common to Predators and Prey.">Animal</a>(), hungryTime(0), starvationTime(0), maxAttackDistance(0), numberPreyKilled(0),  behaviorFamily(NULL)
<a name="l00024"></a>00024 {
<a name="l00025"></a>00025     this-&gt;name = name;
<a name="l00026"></a>00026     this-&gt;species = species;
<a name="l00027"></a>00027 
<a name="l00028"></a>00028     <a class="code" href="class_animal.html#dd621e1dae03d8dea5afeaf1f8b363f1" title="Setup the node heirarchy. This will be the same for both Predators and Prey so it...">setupNodeHeirarchy</a>();
<a name="l00029"></a>00029     <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;<a class="code" href="class_simulation_manager.html#6d21733ca189097b7f25cb7222eec96e" title="Get the PreyManager, this method should only be called from within the simulation...">getPreyManager</a>()-&gt;<a class="code" href="class_prey_manager.html#99f7e5f94809e5d934bf2bd5035097de" title="Register a new Predtor animal to receive notifications from the PreyManager.">registerPredator</a>(<span class="keyword">this</span>);
<a name="l00030"></a>00030     TimerManager::get()-&gt;createTimer(name + species, <span class="keyword">true</span>);
<a name="l00031"></a>00031 
<a name="l00032"></a>00032     <a class="code" href="class_report_manager.html#bf0532c3276a9da9e471a1b3487b62b8" title="Singleton access method.">ReportManager::get</a>()-&gt;<a class="code" href="class_report_manager.html#66d7ecef2aa02ad4a1fbde35ccbd6946" title="Create and return a new ReportSection.">createReportSection</a>(name + species)-&gt;<a class="code" href="class_report_section.html#8c68e08116e46cc2ed394716339823a2" title="Add a message to the ReportSection.">addMessage</a>(<span class="stringliteral">"Predator: "</span> + name + <span class="stringliteral">" Species: "</span> + species);
<a name="l00033"></a>00033 }
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="class_predator.html#9ef1a4a3a5988d1d1e5844a235b36b8b">00035</a> <a class="code" href="class_predator.html#9ef1a4a3a5988d1d1e5844a235b36b8b" title="Deconstructor.">Predator::~Predator</a>()
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037     <a class="code" href="class_animal.html#b0fa6da3c6751de62eca9f513f0a9173" title="Destroy the node heirarchy used by the animal. This should be called in the deconstructor...">destroyNodeHeirarchy</a>();
<a name="l00038"></a>00038     TimerManager::get()-&gt;destroyTimer(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>);
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="class_predator.html#68b6b90edd1137e7ae29c81c1e16a226">00041</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#68b6b90edd1137e7ae29c81c1e16a226" title="Thismethod changes the current behavioral state of the Predator.">Predator::setBehaviorState</a>(<span class="keyword">const</span> BehaviorState&amp; state)
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043     <span class="keywordflow">if</span> (<a class="code" href="class_animal.html#6c1d11d266bf8b0e096f112fca032310" title="The current behavioral state of the Animal.">currentBehavior</a> != state)
<a name="l00044"></a>00044     {
<a name="l00045"></a>00045         <span class="keywordtype">string</span> newState = <span class="stringliteral">""</span>;
<a name="l00046"></a>00046         <span class="keywordtype">string</span> oldState = <span class="stringliteral">""</span>;
<a name="l00047"></a>00047 
<a name="l00048"></a>00048         <span class="keywordflow">switch</span> (state)
<a name="l00049"></a>00049         {
<a name="l00050"></a>00050             <span class="keywordflow">case</span> PASSIVE:
<a name="l00051"></a>00051                 newState = <span class="stringliteral">"Passive"</span>;
<a name="l00052"></a>00052                 <span class="keywordflow">break</span>;
<a name="l00053"></a>00053             <span class="keywordflow">case</span> STALKING:
<a name="l00054"></a>00054                 newState = <span class="stringliteral">"Stalking"</span>;
<a name="l00055"></a>00055                 <span class="keywordflow">break</span>;
<a name="l00056"></a>00056             <span class="keywordflow">case</span> PURSUING:
<a name="l00057"></a>00057                 newState = <span class="stringliteral">"Pursuing"</span>;
<a name="l00058"></a>00058                 <span class="keywordflow">break</span>;
<a name="l00059"></a>00059             <span class="keywordflow">case</span> CAUTIOUS:
<a name="l00060"></a>00060                 newState = <span class="stringliteral">"Cautious"</span>;
<a name="l00061"></a>00061                 <span class="keywordflow">break</span>;
<a name="l00062"></a>00062             <span class="keywordflow">case</span> FLEEING:
<a name="l00063"></a>00063                 newState = <span class="stringliteral">"Fleeing"</span>;
<a name="l00064"></a>00064                 <span class="keywordflow">break</span>;
<a name="l00065"></a>00065         }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067         <span class="keywordflow">switch</span> (<a class="code" href="class_animal.html#6c1d11d266bf8b0e096f112fca032310" title="The current behavioral state of the Animal.">currentBehavior</a>)
<a name="l00068"></a>00068         {
<a name="l00069"></a>00069             <span class="keywordflow">case</span> PASSIVE:
<a name="l00070"></a>00070                 oldState = <span class="stringliteral">"Passive"</span>;
<a name="l00071"></a>00071                 <span class="keywordflow">break</span>;
<a name="l00072"></a>00072             <span class="keywordflow">case</span> STALKING:
<a name="l00073"></a>00073                 oldState = <span class="stringliteral">"Stalking"</span>;
<a name="l00074"></a>00074                 <span class="keywordflow">break</span>;
<a name="l00075"></a>00075             <span class="keywordflow">case</span> PURSUING:
<a name="l00076"></a>00076                 oldState = <span class="stringliteral">"Pursuing"</span>;
<a name="l00077"></a>00077                 <span class="keywordflow">break</span>;
<a name="l00078"></a>00078             <span class="keywordflow">case</span> CAUTIOUS:
<a name="l00079"></a>00079                 oldState = <span class="stringliteral">"Cautious"</span>;
<a name="l00080"></a>00080                 <span class="keywordflow">break</span>;
<a name="l00081"></a>00081             <span class="keywordflow">case</span> FLEEING:
<a name="l00082"></a>00082                 oldState = <span class="stringliteral">"Fleeing"</span>;
<a name="l00083"></a>00083                 <span class="keywordflow">break</span>;
<a name="l00084"></a>00084         }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         <a class="code" href="class_report_manager.html#bf0532c3276a9da9e471a1b3487b62b8" title="Singleton access method.">ReportManager::get</a>()-&gt;<a class="code" href="class_report_manager.html#11879f9ddadf665a650c9d42f909ba05" title="Get a ReportSection.">getReportSection</a>(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>)-&gt;<a class="code" href="class_report_section.html#8c68e08116e46cc2ed394716339823a2" title="Add a message to the ReportSection.">addMessage</a>(<span class="stringliteral">"\t"</span> + <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;getSimulationTime() + <span class="stringliteral">" Changed behavior state from "</span> + oldState + <span class="stringliteral">" to "</span> + newState + <span class="stringliteral">"."</span>);
<a name="l00087"></a>00087         <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;<a class="code" href="class_simulation_manager.html#a34861889ac90cc0c34f9f828c01f3e0" title="Get the PredatorManager, this method should only be called from within the simulation...">getPredatorManager</a>()-&gt;<a class="code" href="class_predator_manager.html#540158953cdde283caf5c86ba113cebf" title="Notify the PredatorManager that a Predator haschanged its state.">predatorStateChanged</a>(<span class="keyword">this</span>);
<a name="l00088"></a>00088         <a class="code" href="class_animal.html#6c1d11d266bf8b0e096f112fca032310" title="The current behavioral state of the Animal.">currentBehavior</a> = state;
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090 }
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="class_predator.html#25935bf2ed0c92597245a304b01bea89">00092</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#25935bf2ed0c92597245a304b01bea89" title="Set how much time will pass before the Predator will become hungry.">Predator::setHungerTime</a>(<span class="keywordtype">double</span> time)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094     <span class="keywordflow">if</span> (time &lt;= 0)
<a name="l00095"></a>00095         time *= -1;
<a name="l00096"></a>00096     <a class="code" href="class_predator.html#22a8b93dc95547e92f62092121701b0a" title="How much time after a successful attack will need to pass before the Predator becomes...">hungryTime</a> = time;
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="class_predator.html#de839a4b51bb4612bb29c3d32ff39f5a">00099</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#de839a4b51bb4612bb29c3d32ff39f5a" title="Set how much time will pass before the Predator will starve.">Predator::setStarvationTime</a>(<span class="keywordtype">double</span> time)
<a name="l00100"></a>00100 {
<a name="l00101"></a>00101     <span class="keywordflow">if</span> (time &lt;= 0)
<a name="l00102"></a>00102         time *= -1;
<a name="l00103"></a>00103     <a class="code" href="class_predator.html#8c04a4a98bb8a2de86501d8f58fdbb54" title="How much time will pass after a Predator becomes hungry that it will starve (in seconds)...">starvationTime</a> = time;
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="class_predator.html#c863054a167d404362f97d7d550cad05">00106</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="class_predator.html#c863054a167d404362f97d7d550cad05" title="Get how hungry the animal is, 0 to 1 means no hunger, 1 to 2 means hungry, and greater...">Predator::getHungerFactor</a>()
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108     TimerManager* timers = TimerManager::get();
<a name="l00109"></a>00109     <span class="keywordflow">if</span> (timers-&gt;getTimerTime(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>) &lt;= <a class="code" href="class_predator.html#22a8b93dc95547e92f62092121701b0a" title="How much time after a successful attack will need to pass before the Predator becomes...">hungryTime</a>)
<a name="l00110"></a>00110         <span class="keywordflow">return</span> timers-&gt;getTimerTime(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>) / <a class="code" href="class_predator.html#22a8b93dc95547e92f62092121701b0a" title="How much time after a successful attack will need to pass before the Predator becomes...">hungryTime</a>;
<a name="l00111"></a>00111     <span class="keywordflow">else</span>
<a name="l00112"></a>00112     {
<a name="l00113"></a>00113         <span class="keywordtype">double</span> currentTime = TimerManager::get()-&gt;getTimerTime(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>) - <a class="code" href="class_predator.html#22a8b93dc95547e92f62092121701b0a" title="How much time after a successful attack will need to pass before the Predator becomes...">hungryTime</a>;
<a name="l00114"></a>00114         <span class="keywordflow">return</span> currentTime /  <a class="code" href="class_predator.html#8c04a4a98bb8a2de86501d8f58fdbb54" title="How much time will pass after a Predator becomes hungry that it will starve (in seconds)...">starvationTime</a> + 1;
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="class_predator.html#7c013010946bbd20731b61ceabdce76a">00118</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#7c013010946bbd20731b61ceabdce76a" title="Set the maximumdistance at which the Predator can attack Prey.">Predator::setMaxAttackDistance</a>(<span class="keywordtype">double</span> distance)
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120     <span class="keywordflow">if</span> (distance == 0)
<a name="l00121"></a>00121         distance = 1;
<a name="l00122"></a>00122     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (distance &lt; 0)
<a name="l00123"></a>00123         <a class="code" href="class_predator.html#9ee093d729781552eba6ea9674a3299e" title="The maximum distance at which the Predator can attack a Prey.">maxAttackDistance</a> = distance * -1;
<a name="l00124"></a>00124     <span class="keywordflow">else</span>
<a name="l00125"></a>00125         <a class="code" href="class_predator.html#9ee093d729781552eba6ea9674a3299e" title="The maximum distance at which the Predator can attack a Prey.">maxAttackDistance</a> = distance;
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="class_predator.html#67a2572923e70b188a14bdcc719e9b89">00128</a> <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="class_predator.html#67a2572923e70b188a14bdcc719e9b89" title="Get the maximum attack range of the Predator.">Predator::getMaxAttackDistance</a>()
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130     <span class="keywordflow">return</span> <a class="code" href="class_predator.html#9ee093d729781552eba6ea9674a3299e" title="The maximum distance at which the Predator can attack a Prey.">maxAttackDistance</a>;
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="class_predator.html#52e23fd1ed395f9c044d635968843811">00133</a> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; <a class="code" href="class_predator.html#52e23fd1ed395f9c044d635968843811" title="Get the number of Prey killed by thePredator.">Predator::getNumberPreyKilled</a>()
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135     <span class="keywordflow">return</span> <a class="code" href="class_predator.html#59996cd2f0a6d55eaafe16926c1de5d9" title="The number of prey killed by the Predator.">numberPreyKilled</a>;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="class_predator.html#5aaaad519c5f10e0f5f01e8821b9eeba">00138</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#5aaaad519c5f10e0f5f01e8821b9eeba" title="Set the PredatorBehaviorFamily of the Predator.">Predator::setBehaviorFamily</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; family)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140     <a class="code" href="class_predator.html#8949682a8e6128262a8f9596188712ac" title="The PredatorBehaviorFamily being used by the Predator.">behaviorFamily</a> = <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;<a class="code" href="class_simulation_manager.html#cb7872e0f6079de1a7ecb5aebc04e237" title="Get a PredatorBehaviorFamily.">getPredatorBehaviorFamily</a>(family);
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="class_predator.html#fae9a5f9d14332bc98125d49ead52be8">00143</a> <a class="code" href="class_predator_behavior_family.html" title="Simple class used for grouping predator behaviors into a related group.">PredatorBehaviorFamily</a>* <a class="code" href="class_predator.html#fae9a5f9d14332bc98125d49ead52be8" title="Get the PredatorBehaviorFamily used by the Predator.">Predator::getBehaviorFamily</a>()
<a name="l00144"></a>00144 {
<a name="l00145"></a>00145     <span class="keywordflow">return</span> <a class="code" href="class_predator.html#8949682a8e6128262a8f9596188712ac" title="The PredatorBehaviorFamily being used by the Predator.">behaviorFamily</a>;
<a name="l00146"></a>00146 }
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="class_predator.html#218797a7e9d4af7f6bc7a59000047045">00148</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#218797a7e9d4af7f6bc7a59000047045" title="Move the Predator.">Predator::move</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; factor)
<a name="l00149"></a>00149 {
<a name="l00150"></a>00150     <a class="code" href="class_animal.html#2da0c22ca6d0fda8334fb8e54092256e" title="Main SceneNode representing the Animal&amp;#39;s position and orientation.">mainNode</a>-&gt;translate(hgeVector(0, <a class="code" href="class_animal.html#a564e0c279d561f92c12c5b63974db53" title="The base speed of the Animal. This is modified by the behaviors.">baseSpeed</a> * <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;getUpdateInterval() * factor));
<a name="l00151"></a>00151     <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;<a class="code" href="class_simulation_manager.html#a34861889ac90cc0c34f9f828c01f3e0" title="Get the PredatorManager, this method should only be called from within the simulation...">getPredatorManager</a>()-&gt;<a class="code" href="class_predator_manager.html#534e801b6acad59355d4f19c343cac9c" title="Notify the PredatorManager that a Predator has moved.">predatorMoved</a>(<span class="keyword">this</span>);
<a name="l00152"></a>00152 }
<a name="l00153"></a>00153 
<a name="l00154"></a><a class="code" href="class_predator.html#9aa6ee5c1bdbbd8b312c9f18a579b960">00154</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#9aa6ee5c1bdbbd8b312c9f18a579b960" title="Attack a Prey animal.">Predator::attack</a>(<a class="code" href="class_prey.html" title="Clss that represents a Prey animal.">Prey</a>* prey)
<a name="l00155"></a>00155 {
<a name="l00156"></a>00156     <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;<a class="code" href="class_simulation_manager.html#a34861889ac90cc0c34f9f828c01f3e0" title="Get the PredatorManager, this method should only be called from within the simulation...">getPredatorManager</a>()-&gt;<a class="code" href="class_predator_manager.html#25f2a364a4e8a9d39619692d17653057" title="Notify the PredatorManager that a Predator has attacked a Prey.">predatorAttacked</a>(<span class="keyword">this</span>, prey);
<a name="l00157"></a>00157     TimerManager::get()-&gt;stopTimer(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>);
<a name="l00158"></a>00158     TimerManager::get()-&gt;startTimer(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>);
<a name="l00159"></a>00159     ++<a class="code" href="class_predator.html#59996cd2f0a6d55eaafe16926c1de5d9" title="The number of prey killed by the Predator.">numberPreyKilled</a>;
<a name="l00160"></a>00160 }
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="class_predator.html#e1d3fd5381993e5bef85c7a36eefe644">00162</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#e1d3fd5381993e5bef85c7a36eefe644" title="Update the Predator.">Predator::update</a>(<span class="keyword">const</span> std::list&lt;Prey*&gt;&amp; movedPrey, <span class="keyword">const</span> std::list&lt;Prey*&gt;&amp; stateChangedPrey)
<a name="l00163"></a>00163 {
<a name="l00164"></a>00164     <span class="keywordflow">if</span> (TimerManager::get()-&gt;getTimerTime(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>) &gt;= <a class="code" href="class_predator.html#22a8b93dc95547e92f62092121701b0a" title="How much time after a successful attack will need to pass before the Predator becomes...">hungryTime</a> + <a class="code" href="class_predator.html#8c04a4a98bb8a2de86501d8f58fdbb54" title="How much time will pass after a Predator becomes hungry that it will starve (in seconds)...">starvationTime</a>)
<a name="l00165"></a>00165     {
<a name="l00166"></a>00166         <a class="code" href="class_report_manager.html#bf0532c3276a9da9e471a1b3487b62b8" title="Singleton access method.">ReportManager::get</a>()-&gt;<a class="code" href="class_report_manager.html#11879f9ddadf665a650c9d42f909ba05" title="Get a ReportSection.">getReportSection</a>(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>)-&gt;<a class="code" href="class_report_section.html#8c68e08116e46cc2ed394716339823a2" title="Add a message to the ReportSection.">addMessage</a>(<span class="stringliteral">"\t"</span> + <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;getSimulationTime() + <span class="stringliteral">" Starved to death."</span>);
<a name="l00167"></a>00167         <a class="code" href="class_report_manager.html#bf0532c3276a9da9e471a1b3487b62b8" title="Singleton access method.">ReportManager::get</a>()-&gt;<a class="code" href="class_report_manager.html#11879f9ddadf665a650c9d42f909ba05" title="Get a ReportSection.">getReportSection</a>(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>)-&gt;<a class="code" href="class_report_section.html#8c68e08116e46cc2ed394716339823a2" title="Add a message to the ReportSection.">addMessage</a>(<span class="stringliteral">"\t"</span> + <span class="keywordtype">string</span>(<span class="stringliteral">"Number of Prey killed: "</span>) + Utils::get()-&gt;intToString(<a class="code" href="class_predator.html#59996cd2f0a6d55eaafe16926c1de5d9" title="The number of prey killed by the Predator.">numberPreyKilled</a>));
<a name="l00168"></a>00168         <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;<a class="code" href="class_simulation_manager.html#a34861889ac90cc0c34f9f828c01f3e0" title="Get the PredatorManager, this method should only be called from within the simulation...">getPredatorManager</a>()-&gt;<a class="code" href="class_predator_manager.html#7731604148ddba62e30ad037d4fad4fd" title="Notify the PredatorManager that a Predator has starved to death.">predatorStarved</a>(<span class="keyword">this</span>);
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170     <span class="keywordflow">else</span>
<a name="l00171"></a>00171     {
<a name="l00172"></a>00172 
<a name="l00173"></a>00173         <a class="code" href="class_animal.html#344b8d2a68820f51db2810fd3844f0d3" title="Update method called by subclasses in their own update method. This has nothing to...">updatePointer</a>();
<a name="l00174"></a>00174         <span class="keywordflow">if</span> (!<a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;isPaused())
<a name="l00175"></a>00175         {
<a name="l00176"></a>00176             TimerManager::get()-&gt;addTimerTime(<a class="code" href="class_animal.html#96fd0789da6971419ec7cd3f9f25d35c" title="Name of the Animal, this should be set in the Constructor of any subclasses.">name</a> + <a class="code" href="class_animal.html#0bf42bfdac7953edc9baf92c78656fc0" title="Species of the animal.">species</a>, <a class="code" href="class_simulation_manager.html#e833896f1f26f4e4f161d366ed5c8bd1" title="Singleton access method.">SimulationManager::get</a>()-&gt;getUpdateInterval());
<a name="l00177"></a>00177             <a class="code" href="class_predator.html#8949682a8e6128262a8f9596188712ac" title="The PredatorBehaviorFamily being used by the Predator.">behaviorFamily</a>-&gt;<a class="code" href="class_predator_behavior_family.html#e4005cdc1115840f8e429fd416d893a3" title="Get one of theBehaviors associated with the BehaviorFamily.">getBehavior</a>(<a class="code" href="class_animal.html#6c1d11d266bf8b0e096f112fca032310" title="The current behavioral state of the Animal.">currentBehavior</a>)-&gt;<a class="code" href="class_predator_behavior.html#3962bfc1b5226d2726e450892568cb34" title="Update the associated Owner using the Behavior.">update</a>(<span class="keyword">this</span>, movedPrey,stateChangedPrey);
<a name="l00178"></a>00178         }
<a name="l00179"></a>00179     }
<a name="l00180"></a>00180 }
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="class_predator.html#0da637022a9a813b501f6be462461f3e">00182</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="class_predator.html#0da637022a9a813b501f6be462461f3e" title="Utility method used to determine if a Predator can see a Prey.">Predator::canSee</a>(<a class="code" href="class_prey.html" title="Clss that represents a Prey animal.">Prey</a>* <span class="keyword">const</span> prey)
<a name="l00183"></a>00183 {
<a name="l00184"></a>00184     hgeVector position = prey-&gt;<a class="code" href="class_animal.html#df388b3f9ece8389a3eec236b4b1d2e0" title="Get the position of the Animal.">getPosition</a>();
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     Utils* utils = Utils::get();
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="keywordtype">double</span> distance = utils-&gt;distanceBetween(<a class="code" href="class_animal.html#df388b3f9ece8389a3eec236b4b1d2e0" title="Get the position of the Animal.">getPosition</a>(), prey-&gt;<a class="code" href="class_animal.html#df388b3f9ece8389a3eec236b4b1d2e0" title="Get the position of the Animal.">getPosition</a>());
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     <span class="keywordflow">if</span> (distance &lt;= (<a class="code" href="class_animal.html#942520bc5b3473295c9addb7d49d5623" title="How far the animal can see, 1 unit = 1 pixel.">sightDistance</a> * (1.0 -prey-&gt;<a class="code" href="class_animal.html#60d6f3eee7aa235abab4d29bee576677" title="Get how well camoflauged the Animal is.">getCamoflauge</a>())))
<a name="l00191"></a>00191     {
<a name="l00192"></a>00192         <span class="keywordtype">double</span> angle = utils-&gt;angleDegrees(utils-&gt;angleBetween(<a class="code" href="class_animal.html#df388b3f9ece8389a3eec236b4b1d2e0" title="Get the position of the Animal.">getPosition</a>(), position));
<a name="l00193"></a>00193         <span class="keywordtype">double</span> halfAngle = <a class="code" href="class_animal.html#a6a20efcab2c8797722371487fddcc22" title="The angle of vision of the animal. ex. A sight angle of 70 would correspond to the...">sightAngle</a> / 2;
<a name="l00194"></a>00194         <span class="keywordflow">if</span> (angle &lt;= (<a class="code" href="class_animal.html#0b2112686e76d5def2ebfe26810c3052" title="Get the heading of the animal in degrees.">getHeading</a>() + halfAngle) &amp;&amp; angle &gt;= (<a class="code" href="class_animal.html#0b2112686e76d5def2ebfe26810c3052" title="Get the heading of the animal in degrees.">getHeading</a>() - halfAngle))
<a name="l00195"></a>00195             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00196"></a>00196         <span class="keywordflow">else</span>
<a name="l00197"></a>00197             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199     <span class="keywordflow">else</span>
<a name="l00200"></a>00200         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="class_predator.html#34dd52beccde13e14ca2bf07f7449c7c">00203</a> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="class_predator.html#34dd52beccde13e14ca2bf07f7449c7c" title="Utility method used to determine if a Predator canhear a Prey.">Predator::canHear</a>(<a class="code" href="class_prey.html" title="Clss that represents a Prey animal.">Prey</a>* <span class="keyword">const</span> prey)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205     <span class="keywordflow">if</span> ((Utils::get()-&gt;distanceBetween(<a class="code" href="class_animal.html#df388b3f9ece8389a3eec236b4b1d2e0" title="Get the position of the Animal.">getPosition</a>(), prey-&gt;<a class="code" href="class_animal.html#df388b3f9ece8389a3eec236b4b1d2e0" title="Get the position of the Animal.">getPosition</a>()) &lt;= (<a class="code" href="class_animal.html#070f5c3b6d5541cd584952b46afb5221" title="How far the animal can effectively hear.">hearingDistance</a> * (1.0 - prey-&gt;<a class="code" href="class_animal.html#03ab9f4fb25fbffad245e06b5330bb28" title="Get the stealth value.">getStealth</a>()))))
<a name="l00206"></a>00206         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00207"></a>00207     <span class="keywordflow">else</span>
<a name="l00208"></a>00208         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00209"></a>00209 }
<a name="l00210"></a>00210 
<a name="l00211"></a><a class="code" href="class_predator.html#aebc6c150f292b8a3dc0b4b524758c88">00211</a> <span class="keywordtype">void</span> <a class="code" href="class_predator.html#aebc6c150f292b8a3dc0b4b524758c88" title="Notify the Predator that it has been spotted by a Prey animal.">Predator::noticed</a>(<a class="code" href="class_prey.html" title="Clss that represents a Prey animal.">Prey</a>* <span class="keyword">const</span> spotter)
<a name="l00212"></a>00212 {
<a name="l00213"></a>00213     <a class="code" href="class_predator.html#8949682a8e6128262a8f9596188712ac" title="The PredatorBehaviorFamily being used by the Predator.">behaviorFamily</a>-&gt;<a class="code" href="class_predator_behavior_family.html#e4005cdc1115840f8e429fd416d893a3" title="Get one of theBehaviors associated with the BehaviorFamily.">getBehavior</a>(<a class="code" href="class_animal.html#6c1d11d266bf8b0e096f112fca032310" title="The current behavioral state of the Animal.">currentBehavior</a>)-&gt;<a class="code" href="class_predator_behavior.html#7289cc474255525d927bd29f61c58dc2" title="Special method used for updating when a Predator has been noticed by a Prey.">predatorNoticed</a>(<span class="keyword">this</span>, spotter);
<a name="l00214"></a>00214 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu May 7 14:49:36 2009 for Simulator by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
